{"version":3,"file":"Popover-5b6ed65c.js","sources":["../../../../packages/react/src/components/Popover/Popover.tsx"],"sourcesContent":["import React from 'react';\nimport classNames from 'classnames';\nimport { Button } from '../Button';\nimport { Popper } from '../Popper';\nimport { useForwardedRef, useId, usePopperTriggers } from '../../utilities';\nimport { PopoverProps } from './types';\n\n/** A popover is a non-modal dialog that points to a reference element. */\nexport const Popover = React.forwardRef<HTMLElement, PopoverProps>(({\n\t// inherited from Popper\n\tisOpen,\n\ttransition = 'fade',\n\treference,\n\tarrowElement,\n\tdistance,\n\tboundary,\n\tplacement = 'top',\n\tmodifiers,\n\tstrategy,\n\tonFirstUpdate,\n\n\t// inherited from usePopperTriggers\n\thideDelay = 300,\n\tshowDelay,\n\tonRequestOpen,\n\tonRequestClose,\n\n\t// unique to Popover\n\ttitle,\n\thideTitle,\n\thideCloseButton,\n\tactions,\n\tbaseName = 'nds-popover',\n\theaderClass = `${baseName}__header`,\n\ttitleClass = `${baseName}__title`,\n\tcloseButtonClass = `${baseName}__close`,\n\tbodyClass = `${baseName}__body`,\n\tactionBarClass = `${baseName}__actions`,\n\tarrowClass,\n\tonClose = (shouldFocusReference) => {\n\t\tif (shouldFocusReference && reference instanceof HTMLElement) {\n\t\t\treference.focus();\n\t\t}\n\t},\n\tonOpen = (popper) => {\n\t\tif (popper) popper.focus();\n\t},\n\n\t// inherited from React.ComponentPropsWithoutRef<'div>\n\tchildren,\n\tclassName,\n\t'aria-labelledby': ariaLabelledby,\n\t'aria-label': ariaLabel,\n\t...props\n}: PopoverProps, ref) => {\n\tconst [popper, setPopper] = useForwardedRef(ref);\n\tconst titleId = useId();\n\tconst focusReferenceOnClose = React.useRef(true);\n\tconst prevOpen = React.useRef(isOpen);\n\n\tconst close: PopoverProps['onRequestClose'] = React.useCallback((trigger) => {\n\t\tfocusReferenceOnClose.current = trigger !== 'click.external';\n\t\tif (onRequestClose) onRequestClose(trigger);\n\t}, [onRequestClose]);\n\n\tconst open: PopoverProps['onRequestOpen'] = (trigger) => {\n\t\tif (onRequestOpen) onRequestOpen(trigger);\n\t};\n\n\tusePopperTriggers({\n\t\treference,\n\t\tpopper,\n\t\ttrigger: 'click',\n\t\tisOpen,\n\t\thideDelay,\n\t\tshowDelay,\n\t\tonRequestClose: close,\n\t\tonRequestOpen: open,\n\t});\n\n\tconst Header = React.useMemo(() => {\n\t\tif ((hideTitle || !title) && hideCloseButton) return null;\n\t\treturn (\n\t\t\t<header className={headerClass}>\n\t\t\t\t{ !hideTitle && title && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={titleClass}\n\t\t\t\t\t\tid={titleId}\n\t\t\t\t\t>\n\t\t\t\t\t\t{title}\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t\t{ !hideCloseButton && (\n\t\t\t\t\t<Button\n\t\t\t\t\t\ticon=\"close\"\n\t\t\t\t\t\ticonOnly\n\t\t\t\t\t\tclassName={closeButtonClass}\n\t\t\t\t\t\tonClick={() => close('click.internal')}\n\t\t\t\t\t\ttooltipProps={{ placement: 'left' }}\n\t\t\t\t\t>\n\t\t\t\t\t\tClose\n\t\t\t\t\t</Button>\n\t\t\t\t) }\n\t\t\t</header>\n\t\t);\n\t}, [\n\t\tclose, closeButtonClass, headerClass, hideCloseButton,\n\t\thideTitle, title, titleClass, titleId,\n\t]);\n\n\tconst ActionBar = React.useMemo(() => {\n\t\tif (!actions) return null;\n\t\treturn (\n\t\t\t<footer className={actionBarClass}>\n\t\t\t\t{ actions }\n\t\t\t</footer>\n\t\t);\n\t}, [actionBarClass, actions]);\n\n\t// call the onOpen/onClose callbacks\n\tReact.useEffect(() => {\n\t\tif (!prevOpen.current && isOpen && popper) {\n\t\t\tonOpen(popper);\n\t\t\tprevOpen.current = true;\n\t\t}\n\n\t\tif (prevOpen.current && !isOpen) {\n\t\t\tonClose(focusReferenceOnClose.current);\n\t\t\tprevOpen.current = false;\n\t\t}\n\t}, [isOpen, onClose, onOpen, popper]);\n\n\tconst accessibleName = React.useMemo(() => {\n\t\t// 1. use the explicit aria-labelledby prop\n\t\tif (ariaLabelledby) return { 'aria-labelledby': ariaLabelledby };\n\t\t// 2. use the explicit aria-label prop\n\t\tif (ariaLabel) return { 'aria-label': ariaLabel };\n\t\t// 3. if `hideTitle`, set aria-label equal to the title\n\t\tif (hideTitle) return { 'aria-label': title };\n\t\t// 4. label the dialog with the visible title\n\t\treturn { 'aria-labelledby': titleId };\n\t}, [ariaLabel, ariaLabelledby, hideTitle, title, titleId]);\n\n\tif (!children) return null;\n\treturn (\n\t\t<Popper\n\t\t\tclassName={classNames(baseName, className)}\n\t\t\tdata-no-title={(hideTitle || !title) ? '' : undefined}\n\t\t\trole=\"dialog\"\n\t\t\taria-modal=\"false\"\n\t\t\t{...accessibleName}\n\t\t\ttabIndex={-1}\n\t\t\tisOpen={isOpen}\n\t\t\ttransition={transition}\n\t\t\treference={reference}\n\t\t\tarrowElement={arrowElement || arrowClass}\n\t\t\tdistance={distance}\n\t\t\tboundary={boundary}\n\t\t\tplacement={placement}\n\t\t\tmodifiers={modifiers}\n\t\t\tstrategy={strategy}\n\t\t\tonFirstUpdate={onFirstUpdate}\n\t\t\tenableArrow\n\t\t\tref={setPopper}\n\t\t\t{...props}\n\t\t>\n\t\t\t{ Header }\n\t\t\t<section className={bodyClass}>{ children }</section>\n\t\t\t{ ActionBar }\n\t\t</Popper>\n\t);\n});\n"],"names":["Popover","React","isOpen","transition","reference","arrowElement","distance","boundary","placement","modifiers","strategy","onFirstUpdate","hideDelay","showDelay","onRequestOpen","onRequestClose","title","hideTitle","hideCloseButton","actions","baseName","headerClass","titleClass","closeButtonClass","bodyClass","actionBarClass","arrowClass","onClose","shouldFocusReference","onOpen","popper","children","className","ariaLabelledby","ariaLabel","props","ref","setPopper","useForwardedRef","titleId","useId","focusReferenceOnClose","prevOpen","close","trigger","usePopperTriggers","Header","jsxs","jsx","Button","ActionBar","accessibleName","Popper","classNames"],"mappings":"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"}