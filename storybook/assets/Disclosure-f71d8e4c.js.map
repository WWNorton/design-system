{"version":3,"file":"Disclosure-f71d8e4c.js","sources":["../../../../packages/react/src/components/BaseDetails/BaseDetails.tsx","../../../../packages/react/src/components/BaseSummary/BaseSummary.tsx","../../../../packages/react/src/components/Disclosure/Disclosure.tsx"],"sourcesContent":["import React from 'react';\nimport { BaseDetailsProps } from './types';\n\nexport const BaseDetails = React.forwardRef<HTMLDetailsElement, BaseDetailsProps>(({\n\tchildren,\n\t...props\n}: BaseDetailsProps, ref) => (\n\t<details ref={ref} {...props}>\n\t\t{ children }\n\t</details>\n));\n","import React from 'react';\nimport { BaseSummaryProps } from './types';\n\nexport const BaseSummary = React.forwardRef<HTMLElement, BaseSummaryProps>(({\n\tmarker,\n\tmarkerPosition = 'left',\n\tchildren,\n\t...props\n}: BaseSummaryProps, ref) => (\n\t<summary\n\t\tref={ref}\n\t\t{...props}\n\t>\n\t\t{/*\n\t\t\tThis div is a temporary fix for safari 14\n\t\t\thttps://bugs.webkit.org/show_bug.cgi?id=190065 - summary can't be flex box\n\t\t*/}\n\t\t<div style={{ display: 'flex', width: '100%' }}>\n\t\t\t{ markerPosition === 'left' && marker }\n\t\t\t{ children }\n\t\t\t{ markerPosition === 'right' && marker }\n\t\t</div>\n\t</summary>\n));\n","import React from 'react';\nimport classNames from 'classnames';\nimport { BaseDetails } from '../BaseDetails';\nimport { BaseSummary } from '../BaseSummary';\nimport { Icon, IconProps } from '../Icon';\nimport { useLayoutEffect } from '../../utilities';\nimport { DisclosureProps } from './types';\n\nconst proceed = async (cb?: DisclosureProps['onCloseStart']): Promise<boolean> => {\n\tif (cb) {\n\t\treturn (await cb()) !== false;\n\t}\n\treturn true;\n};\n\nexport const Disclosure = React.forwardRef<HTMLDetailsElement, DisclosureProps>(({\n\tisOpen: propOpen = false,\n\treducedMotion,\n\tsummary,\n\tchildren,\n\tmarker = (p) => {\n\t\tif (p) return 'chevron-down';\n\t\treturn 'caret-right';\n\t},\n\tmarkerPosition = (p) => {\n\t\tif (p) return 'right';\n\t\treturn 'left';\n\t},\n\tmarkerTransform,\n\tpanel,\n\n\tclassName,\n\tbaseName = 'nds-disclosure',\n\tsummaryClass = `${baseName}__summary`,\n\tmarkerClass = `${baseName}__marker`,\n\tcontentsOuterClass = `${baseName}__contents-outer`,\n\tcontentsInnerClass = `${baseName}__contents-inner`,\n\n\tonCloseStart,\n\tonCloseCancel,\n\tonCloseEnd,\n\tonOpenStart,\n\tonOpenCancel,\n\tonOpenEnd,\n\t...props\n}: DisclosureProps, ref): JSX.Element => {\n\tconst [isOpen, setOpen] = React.useState(propOpen);\n\tconst [height, setHeight] = React.useState<number>();\n\tconst [state, setState] = React.useState<'opening' | 'closing'>();\n\tconst [style, setStyle] = React.useState<React.CSSProperties>();\n\tconst [contents, setContents] = React.useState<HTMLDivElement | null>(null);\n\tconst transform = React.useMemo<typeof markerTransform>(() => {\n\t\tif (markerTransform) return markerTransform;\n\t\treturn (panel) ? 'flip-3d' : 'rotate-90';\n\t}, [markerTransform, panel]);\n\n\tconst shouldAnimate = React.useMemo(() => {\n\t\tif (reducedMotion) return false;\n\t\tif (!contents) return true;\n\t\tconst styles = window.getComputedStyle(contents);\n\t\treturn styles.getPropertyValue('transition-duration')\n\t\t\t.split(/,\\s*/)\n\t\t\t.some((value) => parseFloat(value) > 0);\n\t}, [reducedMotion, contents]);\n\n\tconst open = React.useCallback(async () => {\n\t\tif (isOpen || state === 'opening') return;\n\t\tif (state === 'closing') {\n\t\t\tif (await proceed(onCloseCancel)) {\n\t\t\t\tsetState((shouldAnimate) ? 'opening' : undefined);\n\t\t\t}\n\t\t} else if (await proceed(onOpenStart)) {\n\t\t\tsetOpen(true);\n\t\t}\n\t}, [isOpen, state, shouldAnimate, onCloseCancel, onOpenStart]);\n\n\tconst close = React.useCallback(async () => {\n\t\tif (!isOpen || state === 'closing') return;\n\t\tif (state === 'opening') {\n\t\t\tif (await proceed(onOpenCancel)) {\n\t\t\t\tsetState((shouldAnimate) ? 'closing' : undefined);\n\t\t\t}\n\t\t} else if (await proceed(onCloseStart)) {\n\t\t\tif (shouldAnimate) {\n\t\t\t\tsetStyle({ height });\n\t\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\t\tsetState('closing');\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsetOpen(false);\n\t\t\t}\n\t\t}\n\t}, [isOpen, state, height, shouldAnimate, onOpenCancel, onCloseStart]);\n\n\tconst summaryClickHandler = (e: React.MouseEvent<HTMLElement>): void => {\n\t\te.preventDefault();\n\t\tif (isOpen) close();\n\t\telse open();\n\t};\n\n\tconst transitionEndHandler = (): void => {\n\t\tsetState(undefined);\n\t\tsetStyle(undefined);\n\n\t\tif (state === 'opening') {\n\t\t\tif (onOpenEnd) onOpenEnd();\n\t\t}\n\t\tif (state === 'closing') {\n\t\t\tsetOpen(false);\n\t\t\tif (onCloseEnd) onCloseEnd();\n\t\t}\n\t};\n\n\t// control via `isOpen` prop\n\tReact.useEffect(() => {\n\t\tif (propOpen) open();\n\t\telse close();\n\t}, [propOpen]);\t// eslint-disable-line react-hooks/exhaustive-deps\n\n\t// open start effect: discover height, set height to 0, then trigger 'opening'\n\tuseLayoutEffect(() => {\n\t\tif (!isOpen) setState(undefined);\n\t\tif (isOpen && contents) {\n\t\t\tsetHeight(contents.offsetHeight);\n\t\t\tif (shouldAnimate) {\n\t\t\t\tsetStyle({ height: 0 });\n\t\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\t\tsetState('opening');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, [isOpen, contents, shouldAnimate]);\n\n\t// set the style height when opening/closing\n\tReact.useEffect(() => {\n\t\tif (shouldAnimate) {\n\t\t\tif (state === 'opening' && height) {\n\t\t\t\tsetStyle({ height });\n\t\t\t}\n\t\t\tif (state === 'closing') {\n\t\t\t\tsetStyle({ height: 0 });\n\t\t\t}\n\t\t} else {\n\t\t\tsetStyle(undefined);\n\t\t}\n\t}, [state, height, shouldAnimate]);\n\n\tconst getMarkerIcon = React.useCallback((\n\t\tm: typeof marker,\n\t): Pick<IconProps, 'variant' | 'icon'> | undefined => {\n\t\tif (!m) return undefined;\n\t\tif (typeof m === 'string') return { variant: m };\n\t\tif (typeof m === 'function') return getMarkerIcon(m(panel));\n\t\treturn { icon: m };\n\t}, [panel]);\n\n\tconst Marker = React.useMemo(() => {\n\t\tif (!marker) return undefined;\n\t\tconst iconProps = getMarkerIcon(marker);\n\t\treturn (\n\t\t\t<span className={markerClass}>\n\t\t\t\t<Icon\n\t\t\t\t\t{...iconProps}\n\t\t\t\t\tdata-transform={transform}\n\t\t\t\t/>\n\t\t\t</span>\n\t\t);\n\t}, [marker, markerClass, transform, getMarkerIcon]);\n\n\tconst markerPos = React.useMemo(() => {\n\t\tif (!markerPosition) return undefined;\n\t\tif (typeof markerPosition === 'function') {\n\t\t\treturn markerPosition(panel) || undefined;\n\t\t}\n\t\treturn markerPosition;\n\t}, [markerPosition, panel]);\n\n\tconst classes = classNames(\n\t\tclassName,\n\t\tbaseName,\n\t\tstate && `nds-${state}`,\n\t\t{\n\t\t\t[`${baseName}--panel`]: panel,\n\t\t\t'nds-reduced-motion': !shouldAnimate,\n\t\t},\n\t);\n\n\treturn (\n\t\t<BaseDetails ref={ref} className={classes} open={isOpen} {...props}>\n\t\t\t<BaseSummary\n\t\t\t\tclassName={summaryClass}\n\t\t\t\tmarker={Marker}\n\t\t\t\tonClick={summaryClickHandler}\n\t\t\t\tmarkerPosition={markerPos}\n\t\t\t>\n\t\t\t\t<span className={`${baseName}__title`}>{ summary }</span>\n\t\t\t</BaseSummary>\n\t\t\t{ isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tstyle={style}\n\t\t\t\t\tclassName={contentsOuterClass}\n\t\t\t\t\tref={setContents}\n\t\t\t\t\tonTransitionEnd={transitionEndHandler}\n\t\t\t\t>\n\t\t\t\t\t<div className={contentsInnerClass}>{ children }</div>\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</BaseDetails>\n\t);\n});\n"],"names":["BaseDetails","React","children","props","ref","jsx","BaseSummary","marker","markerPosition","jsxs","proceed","cb","Disclosure","propOpen","reducedMotion","summary","p","markerTransform","panel","className","baseName","summaryClass","markerClass","contentsOuterClass","contentsInnerClass","onCloseStart","onCloseCancel","onCloseEnd","onOpenStart","onOpenCancel","onOpenEnd","isOpen","setOpen","height","setHeight","state","setState","style","setStyle","contents","setContents","transform","shouldAnimate","value","open","close","summaryClickHandler","e","transitionEndHandler","useLayoutEffect","getMarkerIcon","m","Marker","iconProps","Icon","markerPos","classes","classNames"],"mappings":"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"}